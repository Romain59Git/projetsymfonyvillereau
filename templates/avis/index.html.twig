{% extends 'base.html.twig' %}

{% block title %}Vos avis - CDJ Villereau{% endblock %}

{% block body %}
<div class="avis-container">
    <h1 class="avis-title">Donnez votre avis</h1>

    {% for message in app.flashes('success') %}
        <div class="flash-message flash-success">
            {{ message }}
        </div>
    {% endfor %}

    <form method="post" class="avis-form">
        <div class="form-group">
            <label for="name">Votre nom</label>
            <input type="text" id="name" name="name" required>
        </div>

        <div class="form-group">
            <label>Note</label>
            <div class="rating-group">
                <div class="star-rating">
                    <input type="radio" id="star5" name="rating" value="5" required>
                    <label for="star5">★</label>
                    <input type="radio" id="star4" name="rating" value="4">
                    <label for="star4">★</label>
                    <input type="radio" id="star3" name="rating" value="3">
                    <label for="star3">★</label>
                    <input type="radio" id="star2" name="rating" value="2">
                    <label for="star2">★</label>
                    <input type="radio" id="star1" name="rating" value="1">
                    <label for="star1">★</label>
                </div>
            </div>
        </div>

        <div class="form-group">
            <label for="comment">Votre avis</label>
            <textarea id="comment" name="comment" rows="5" required></textarea>
        </div>

        <button type="submit" class="submit-btn">
            <i class="fas fa-paper-plane"></i>
            Envoyer mon avis
        </button>
    </form>

    {% if avis|length > 0 %}
        <div class="avis-list">
            <h2>Avis des membres</h2>
            {% for avi in avis %}
                <div class="avis-card">
                    <div class="avis-header">
                        <span class="avis-author">{{ avi.name }}</span>
                        <span class="avis-date">{{ avi.createdAt|date('d/m/Y') }}</span>
                    </div>
                    <div class="avis-rating">
                        {% for i in 1..5 %}
                            {% if i <= avi.rating %}
                                ★
                            {% else %}
                                ☆
                            {% endif %}
                        {% endfor %}
                    </div>
                    <div class="avis-content">
                        {{ avi.comment }}
                    </div>
                </div>
            {% endfor %}
        </div>
    {% endif %}
</div>
{% endblock %}
